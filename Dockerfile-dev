FROM python:2.7
ENV PYTHONUNBUFFERED 1

# Requirements have to be pulled and installed here, otherwise caching won't work
COPY ./requirements.txt /app/requirements.txt
COPY ./requirements.dev.txt /app/requirements.dev.txt
COPY ./requirements.production.txt /app/requirements.production.txt

RUN pip install -r /app/requirements.txt && \
    pip install -r /app/requirements.dev.txt && \
    pip install -r /app/requirements.production.txt


EXPOSE 8000
WORKDIR /app

CMD gunicorn --workers 3 --bind 0.0.0.0:8000 manager:app --chdir=/app/opac --log-level DEBUG
