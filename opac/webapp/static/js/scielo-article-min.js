var Article={TopBinder:[],Init:function(){var e=$("#articleText"),t=e.offset(),i=$(".articleMenu").width();$(".articleSection",e);$(".ModalTables").on("shown.bs.modal",function(){var e=$(".modal-body",this),t=$("table",e),i=e.outerWidth(),a=t.outerWidth();e.is("cached")||(t.addClass("table"),a>i?t.addClass("autoWidth"):t.removeClass("autoWidth")),e.addClass("cached")}),$(".ref").on("mouseenter mouseleave",function(e){var t=$(this),i=$(".xref",t),a=i.next("span:eq(0)"),o=t.position(),n=(i.outerHeight(),o.left),l=t.closest("li");"mouseenter"===e.type?(l.length>0&&l.addClass("zindexFix"),a.removeClass("closed").addClass("opened").css({left:n>300?-n/3:0}).fadeIn("fast")):(l.length>0&&l.removeClass("zindexFix"),a.removeClass("opened").addClass("closed"))}),$(".thumb").on("mouseenter mouseleave",function(e){var t=$(this).parent().parent().find(".preview");"mouseenter"==e.type?t.fadeIn("fast"):"mouseleave"==e.type&&t.fadeOut("fast")}),$(".ModalTables").on("shown.bs.modal",function(){0==$("table td[colspan], table td[rowspan]",this).length&&$("table",this).addClass("table-hover")}),$(".collapseTitle").on("click",function(){var e=$(this).next(),t=$(this).find(".collapseIcon");e.is(":visible")?(e.slideUp("fast"),t.removeClass("opened")):(e.slideDown("fast"),t.addClass("opened"))}),$(".expandReduceText").on("click",function(e){e.preventDefault();var t=$("#articleText .ref"),i=$("#articleText .text"),a=$(this).data("expandreducetext");void 0===$(this).data("defaultwidth")&&$(this).data("defaultwidth",i.outerWidth()),1==a?(t.hide(),i.outerWidth("100%"),$(this).data("expandreducetext",!1)):(i.width(""),t.show(),$(this).data("expandreducetext",!0));var o=$(window).scrollTop();setTimeout(function(){Article.ArticleStructureBuilder(),Article.ArticleStructureSelect(o)},100)}),$(".articleTxt .xref:not(.big)").on("click",function(){var e=$(this).text();$(".ref-list");-1==e.indexOf(",")?(parseInt(e),e--):(e=(e=e.split(","))[0],parseInt(e),e--)}),Article.ArticleStructureBuilder(),t.top=t.top-25;var a=e.outerHeight(),o=$(".articleMenu").height();if(window.setTimeout(function(){o=$(".articleMenu").height()},200),$(window).scroll(function(){var e=$(window).scrollTop();Article.isScrolledIntoView(".floatingMenuCtt")?($(".floatingMenuItem").css({position:"absolute"}),$(".floatingMenu").css({position:"absolute"})):($(".floatingMenuItem").css({position:"fixed"}),$(".floatingMenu").css({position:"fixed"})),e>t.top?($(".articleMenu").addClass("fixed").width(i),e>a+t.top-o-46?$(".articleMenu").addClass("fixedBottom"):$(".articleMenu").removeClass("fixedBottom")):$(".articleMenu").removeClass("fixed"),Article.ArticleStructureSelect(e),$(".alternativeHeader").stop(!1,!1)}),""!=window.location.hash){var n=window.location.hash,l=window.scrollY;$(n).modal("toggle").on("hidden.bs.modal",function(){window.location.hash="",$("body,html").scrollTop(l)})}$("[data-toggle='modal']").on("click",function(){var e=$(this).data("target"),t=window.scrollY;"undefined"==e&&""==e||(window.location.hash=e),$(e).on("hidden.bs.modal",function(){window.location.hash="",$("body,html").scrollTop(t)})});var r=$(".downloadOptions li.group"),s=100/r.length;r.css("width",s+"%"),Article.fechaAutores();var d=!1;$(".short-link").mouseenter(function(e){if(!d){if(-1!==(t=window.location.href).indexOf("localhost"))var t="http://www.scielo.br";$.ajax({type:"GET",async:!1,url:"http://ref.scielo.org/api/v1/shorten",data:"url="+encodeURI(t),dataType:"jsonp",success:function(e){result=e,d=!0}})}});var c=new Clipboard(".short-link",{text:function(e){return result}});c.on("success",function(e){var t=$(e.trigger);t.addClass("copyFeedback"),setTimeout(function(){t.removeClass("copyFeedback")},2e3)}),c.on("error",function(e){var t=$(e.trigger);t.addClass("copyFeedbackError"),setTimeout(function(){t.removeClass("copyFeedbackError")},2e3)})},isScrolledIntoView:function(e){var t=$(window).scrollTop(),i=t+$(window).height(),a=$(e).offset().top;return a+$(e).height()<=i&&a>=t},ArticleStructureBuilder:function(){var e=$(".articleMenu"),t=$("#articleText .articleSection"),i=0,a="";Article.TopBinder=[],t.each(function(){var e=$(this).data("anchor"),t=$(this).find(".articleSectionTitle"),o=$(this).offset();if(0==$(this).find("a[name='articleSection"+i+"']").length&&$(this).prepend("<a name='articleSection"+i+"'></a>"),0==i?Article.TopBinder.push(0):Article.TopBinder.push(o.top),void 0===e)return!0;if(a+="<li "+(0==i?'class="selected"':"")+">",a+='\t<a href="#articleSection'+i+'">'+e+"</a>",t.length>1){var n=0;a+="<ul>",t.each(function(){var e=$(this).offset();Article.TopBinder.push(e.top),0==$(this).prev("a[name='as"+i+"-heading"+n+"']").length&&$(this).before("<a name='as"+i+"-heading"+n+"'></a>"),a+="<li>",a+='\t<a href="#as'+i+"-heading"+n+'">'+$(this).text()+"</a>",a+="</li>",n++}),a+="</ul>"}a+="</li>",i++}),e.html(a),$("a",e).on("click",function(e){e.preventDefault();var t=$(this).attr("href");t=t.replace("#","");var i=$("a[name="+t+"]").offset();$("html,body").animate({scrollTop:i.top-60},500)})},ArticleStructureSelect:function(e){for(var t=$(".articleMenu"),i=0,a=Article.TopBinder.length;i<a;i++){if(i==a-1&&e>=Article.TopBinder[i]-100){t.find("li").removeClass("selected"),t.find("li:eq("+i+")").addClass("selected");break}if(e<=Article.TopBinder[i]-100){t.find("li").removeClass("selected"),t.find("li:eq("+(i-1)+")").addClass("selected");break}}},Bindings:function(e){void 0===e&&(e=".article")},fechaAutores:function(){var e=$(".contribGroup"),t=$(".contribGroup .dropdown"),i=t.length;if(i>=10){var a=null,o=$(".outlineFadeLink"),n=t[0],l=t[i-1],r=i-2,s=$('<a data-toggle="tooltip" data-placement="top" title="+'+r+'"></a>');s.text("[...]"),s.css({padding:"10px",cursor:"pointer"});var d=$("<div></div>"),c=$("<a></a>");c.addClass("btn-fechar");var u=$("<span></span>");u.addClass("sci-ico-floatingMenuClose"),c.append(u),d.append(c);var p=$("<div></div>");p.append(n),p.append(s),p.append(l),p.append(o),e.text(""),e.append(p),s.on("click",function(){a.tooltip("disable"),e.textContent="";for(var n=0;n<i;n++)e.append(t[n]);e.append(o),e.append(d)}),c.on("click",function(){a.tooltip("enable"),Article.fechaAutores()}),a=$('[data-toggle="tooltip"]').tooltip()}e.css("opacity","1")}};$(function(){$("body.article").length&&Article.Init()});